<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="ja">

  <head>
    <meta http-equiv="Content-Style-Type" content="text/css">
    <meta http-equiv="Content-Script-Type" content="text/javascript">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="Description" content="gren is a grep next tool, create by ruby.">
    <meta name="Keywords" content="grep,ruby,gem,next,tool,search">
    <title>gren - gren is a next grep tool.</title>
    <link rel="stylesheet" href="../style.css" type="text/css" media="screen,tv">
  </head>

  <body>
    <div id="wrapper">
      <div id="header">
        <!-- 見出し -->
        <h1><a href="../ja/index.html">[Japanese]</a> <a href="../en/index.html">[English]</a></h1>
        <!-- タイトル -->
        <p class="logo"><a href="index.html">gren</a></p>
        <!-- 概要 -->
        <p class="description">gren is a next grep tool.</p>
      </div><!-- / header end -->
      <div id="globalnavi">
        <!-- グローバルナビゲーション -->
        <ul>
          <li><a href="index.html">Home</a></li>
          <li><a href="feature.html">特徴</a></li>
          <li><a href="download.html">ダウンロード</a></li>
          <li><a href="readme.html">使い方</a></li>
          <li><a href="history.html">更新履歴</a></li>
        </ul>
      </div><!-- / globalnavi end -->

      <div id="contents">
        <h1>使い方</h1>

<h2>--help</h2>
<pre>
% gren --help
gren [option] pattern [dir]
    -i, --ignore                     大文字小文字の違いを無視します。
    -l, --listing                    リスティングモードになります、探索対象となったファイルの一覧を表示します。
    -f, --file-regexp REGEXP         探索対象となるファイルの正規表現 (default: ".")
        --if, --ignore-file REGEXP   探索対象から外すファイルの正規表現
        --id, --ignore-dir REGEXP    探索対象から外すディレクトリの正規表現
                                     --id で指定されたディレクトリはそれ以下の探索自体がスキップされます
</pre>

<h2>現在ディレクトリ以下で&quot;FileTest&quot;を検索</h2>
<pre>
% gren FileTest
pkg/gren-0.0.5/lib/gren/findgrep.rb:34:        next unless FileTest.file?(fpath)
pkg/gren-0.0.5/lib/gren/findgrep.rb:39:        unless FileTest.readable?(fpath)
pkg/gren-0.0.5/lib/gren/findgrep.rb:44:        @result.size += FileTest.size(fpath)
pkg/gren-0.0.5/lib/gren/findgrep.rb:53:        @result.search_size += FileTest.size(fpath)
pkg/gren-0.0.5/lib/gren/findgrep.rb:95:      FileTest.directory?(fpath) &amp;&amp;
pkg/gren-0.0.4/lib/gren/findgrep.rb:34:        next unless FileTest.file?(fpath)
pkg/gren-0.0.4/lib/gren/findgrep.rb:39:        unless FileTest.readable?(fpath)
pkg/gren-0.0.4/lib/gren/findgrep.rb:44:        @result.size += FileTest.size(fpath)
pkg/gren-0.0.4/lib/gren/findgrep.rb:53:        @result.search_size += FileTest.size(fpath)
pkg/gren-0.0.4/lib/gren/findgrep.rb:95:      FileTest.directory?(fpath) &amp;&amp;
lib/gren/findgrep.rb:34:        next unless FileTest.file?(fpath)
lib/gren/findgrep.rb:39:        unless FileTest.readable?(fpath)
lib/gren/findgrep.rb:44:        @result.size += FileTest.size(fpath)
lib/gren/findgrep.rb:53:        @result.search_size += FileTest.size(fpath)
lib/gren/findgrep.rb:95:      FileTest.directory?(fpath) &amp;&amp;

dir   : /Users/ongaeshi/Documents/gren (0.01sec)
files : 49 in 53 (35.63KB in 61.53KB)
match : 3 files, 15 hit
</pre>

<h2>ひとつ上のディレクトリで"FileTest"を検索</h2>
<pre>
% gren FileTest ..
../gren-html/ja/readme_old.html:134: FileTestを検索
../gren/lib/gren/findgrep.rb:34:        next unless FileTest.file?(fpath)
.
.

dir   : /Users/ongaeshi/Documents (39.97sec)
files : 12041 in 15861 (99.79MB in 460.8MB)
match : 11 files, 168 hit
</pre>

<h2>pkg/ディレクトリ以下、.rbファイルに限定して&quot;FILE&quot;を検索</h2>
<ol>
  <li>"FILE"を検索する
  <li>ただし.rbファイルに限定(-f)
  <li>file : 32 in 36 → file : 14 in 36 になっていることに注目
</ol>
<pre>
% gren FILE -f &quot;\.rb$&quot;
pkg/gren-0.0.5/test/test_helper.rb:3:require File.dirname(__FILE__) + '/../lib/gren'
.
.
.
pkg/gren-0.0.4/lib/gren/cli.rb:3:require File.join(File.dirname(__FILE__), 'findgrep')

dir   : /Users/ongaeshi/Documents/gren/pkg (0.1sec)
files : 14 in 36 (15.36KB in 48.54KB)
match : 12 files, 18 hit
</pre>

<h2>検索対象を絞り込み、除外ディレクトリを指定</h2>
<ol>
  <li>"FILE"を検索する
  <li>ただし.rbファイルに限定して(-f)
  <li>さらにpkg/ディレクトリ以下は探索対象から除外(--id)
  <li>--id で指定されたディレクトリはそれ以下の探索自体がスキップされます
</ol>
<pre>
% gren FILE -f &quot;\.rb$&quot; --id pkg
test/test_helper.rb:3:require File.dirname(__FILE__) + '/../lib/gren'
test/test_gren_cli.rb:1:require File.join(File.dirname(__FILE__), &quot;test_helper.rb&quot;)
test/test_gren.rb:1:require File.dirname(__FILE__) + '/test_helper.rb'
lib/gren.rb:1:$:.unshift(File.dirname(__FILE__)) unless
lib/gren.rb:2:  $:.include?(File.dirname(__FILE__)) || $:.include?(File.expand_path(File.dirname(__FILE__)))
lib/gren/findgrep.rb:3:require File.join(File.dirname(__FILE__), 'result')
lib/gren/findgrep.rb:7:    IGNORE_FILE = /(\A#.*#\Z)|(~\Z)|(\A\.#)/
lib/gren/findgrep.rb:103:      IGNORE_FILE.match(File.basename(fpath)) ||
lib/gren/cli.rb:3:require File.join(File.dirname(__FILE__), 'findgrep')

dir   : /Users/ongaeshi/Documents/gren (0.01sec)
files : 7 in 17 (7.68KB in 11.32KB)
match : 6 files, 9 hit
</pre>

<h2>検索対象を絞り込み、除外ディレクトリ、除外ファイル</h2>
<ol>
  <li>"FILE"を検索する
  <li>ただし.rbファイルに限定(-f)
  <li>さらにpkg/ディレクトリ以下は探索対象から除外(--id)
  <li>test_*.rbという名前のファイルも除外(--if)
</ol>
<pre>
% gren FILE -f &quot;\.rb$&quot; --id pkg --if &quot;test_.+\.rb$&quot;
lib/gren.rb:1:$:.unshift(File.dirname(__FILE__)) unless
lib/gren.rb:2:  $:.include?(File.dirname(__FILE__)) || $:.include?(File.expand_path(File.dirname(__FILE__)))
lib/gren/findgrep.rb:3:require File.join(File.dirname(__FILE__), 'result')
lib/gren/findgrep.rb:7:    IGNORE_FILE = /(\A#.*#\Z)|(~\Z)|(\A\.#)/
lib/gren/findgrep.rb:103:      IGNORE_FILE.match(File.basename(fpath)) ||
lib/gren/cli.rb:3:require File.join(File.dirname(__FILE__), 'findgrep')

dir   : /Users/ongaeshi/Documents/gren (0.0sec)
files : 4 in 17 (7.07KB in 11.32KB)
match : 3 files, 6 hit
</pre>

<h2>-iオプションを付けると大文字、小文字の違いを無視する</h2>
<pre>
% gren FILE -i -f &quot;\.rb$&quot; --id pkg --if &quot;test_.+\.rb$&quot;
lib/gren.rb:1:$:.unshift(File.dirname(__FILE__)) unless
lib/gren.rb:2:  $:.include?(File.dirname(__FILE__)) || $:.include?(File.expand_path(File.dirname(__FILE__)))
lib/gren/result.rb:8:    attr_accessor :match_file_count
.
.
.
lib/gren/cli.rb:16:      opt.on('--if REGEXP', '--ignore-file REGEXP', 'Ignore file pattern.') {|v| option.ignoreFile = v}

dir   : /Users/ongaeshi/Documents/gren (0.1sec)
files : 4 in 17 (7.07KB in 11.32KB)
match : 4 files, 53 hit
</pre>

<h2>-lでリスティングモード</h2>
<p>
探索時に辿ったファイル、マッチしたファイル、無視したファイル、無視したディレクトリ、読み込み禁止で読めなかったもの等が一覧出来る<br>
大量にテキストが出力される可能性があるので注意(リダイレクト推奨)
</p>
<pre>
% gren FILE -l
test/test_helper.rb:3:require File.dirname(__FILE__) + '/../lib/gren'
.
.

--- search --------
test/test_helper.rb
test/test_gren_cli.rb
.
.
total: 49

--- match --------
test/test_helper.rb
test/test_gren_cli.rb
.
.
total: 30

--- ignore-file --------
pkg/gren-0.0.5.tgz
pkg/gren-0.0.5.gem
.
.
total: 4

--- ignore-dir --------
.git
total: 1

--- unreadable --------
total: 0

dir   : /Users/ongaeshi/Documents/gren (0.01sec)
files : 49 in 53 (33.96KB in 59.86KB)
match : 30 files, 42 hit
</pre>

<h2>おまけ : 自分のホームディレクトリでエゴサーチ(結構ヒットするなー)</h2>
<pre>
% cd ~
% gren ongaeshi
.
.
.

dir   : /Users/ongaeshi (8m 52.45s)
files : 70237 in 153566 (713.45MB in 91.92GB)
match : 44 files, 162 hit
</pre>
      </div><!-- / contents end -->

      <div id="footer">
        <p>Copyright © <a href="http://d.hatena.ne.jp/tuto0621/">ongaeshi</a>. All Rights Reserved.</p><!-- コピーライト -->
        <p id="cds">CSS Template <a href="http://www.css-designsample.com/">CSSデザインサンプル</a></p>
      </div><!-- / footer end -->

    </div><!-- / wrapper end -->
</body></html>
